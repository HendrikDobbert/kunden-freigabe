<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Back in the Building GmbH: Finale Content-Freigabe KW 40</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="icon" href="https://backinthebuilding.com/wp-content/uploads/2024/12/cropped-LOGOS.pdf-200-x-200-px-150x119.png" sizes="32x32">
    <link href="https://fonts.googleapis.com/css2?family=Figtree:wght@400;600;800&family=Domine:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ci-primary: #66ACB1;
            --ci-secondary: #3C797D;
            --ci-secondary-hover: #2E5A5D;
            --ci-text-dark: #333333;
            --ci-text-grey: #54595F;
            --ci-accent-green: #0CE72A;
            --ci-red-reset: #dc3545;
            --bg-light: #F7F7F7;
            --bg-white: #ffffff;
            --border-color: #e0e0e0;
        }

        body {
            font-family: 'Figtree', sans-serif;
            background-color: var(--bg-light);
            color: var(--ci-text-grey);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .brochure {
            max-width: 800px;
            margin: 0 auto;
            background-color: var(--bg-white);
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-radius: 8px;
        }
        .header {
            background-color: var(--bg-white);
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
        }
        .header img {
            max-height: 50px;
            margin-bottom: 15px;
        }
        .header h1 {
            font-family: 'Figtree', sans-serif;
            font-weight: 800;
            text-transform: uppercase;
            font-size: 28px;
            margin: 0;
            color: var(--ci-secondary);
        }
        .header p {
            margin: 5px 0 0 0;
            font-size: 16px;
            opacity: 0.9;
        }
        .section {
            padding: 30px;
            border-bottom: 1px solid var(--border-color);
        }
        .section:last-of-type { border-bottom: none; }

        .section p {
            font-size: 18px;
            color: var(--ci-text-dark);
            line-height: 1.7;
        }
        
        h2 {
            font-family: 'Domine', serif;
            font-weight: 700;
            font-size: 1.75rem;
            color: var(--ci-secondary);
            border-bottom: 2px solid var(--ci-primary);
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 20px;
        }
        
        .responsive-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .responsive-table th {
            padding: 12px;
            border-bottom: 2px solid var(--border-color);
            text-align: left;
            font-family: 'Figtree', sans-serif;
            font-weight: 600;
            color: var(--ci-text-dark);
        }
        .responsive-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
        }
        .responsive-table tbody tr:last-child td {
            border-bottom: none;
        }
        .asset-title {
            display: block;
            color: var(--ci-text-dark);
            font-weight: 600;
            font-size: 16px;
        }
        .asset-description {
            font-size: 14px;
            color: var(--ci-text-grey);
        }
        
        .view-button {
            display: inline-block;
            background-color: var(--ci-text-grey);
            color: #ffffff;
            padding: 8px 15px;
            border-radius: 3px;
            text-decoration: none;
            font-weight: bold;
            font-size: 14px;
            transition: all .2s;
        }
        .view-button:hover {
            background-color: var(--ci-secondary);
        }

        .feedback-textarea {
            width: 100%;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 8px;
            font-family: 'Figtree', sans-serif;
            font-size: 14px;
            resize: vertical;
            min-height: 40px;
        }
        .approval-checkbox { display: none; }
        .approval-label {
            display: inline-block;
            background-color: #6c757d;
            color: #ffffff;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.2s ease;
            text-align: center;
            min-width: 90px;
        }
        .approval-label .text-approve { display: inline; }
        .approval-label .text-approved { display: none; }
        .approval-checkbox:checked + .approval-label {
            background-color: var(--ci-accent-green);
        }
        .approval-checkbox:checked + .approval-label .text-approve { display: none; }
        .approval-checkbox:checked + .approval-label .text-approved { display: inline; }
        
        .rating { display: flex; flex-direction: row-reverse; justify-content: center; }
        .rating input { display: none; }
        .rating label { font-size: 22px; color: #ccc; cursor: pointer; transition: color 0.2s; }
        .rating label:hover, .rating label:hover ~ label, .rating input:checked ~ label { color: var(--ci-secondary); }

        .footer-button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }
        .footer-button {
            border: none;
            padding: 12px 25px;
            font-family: 'Figtree', sans-serif;
            font-size: 15px;
            font-weight: bold;
            text-transform: uppercase;
            border-radius: 3px;
            cursor: pointer;
            transition: all .3s;
        }
        .reset-button {
            background-color: var(--bg-white);
            color: var(--ci-red-reset);
            border: 2px solid var(--ci-red-reset);
        }
        .reset-button:hover {
            background-color: var(--ci-red-reset);
            color: white;
        }
        .submit-global-button {
            background-color: var(--ci-secondary);
            color: #ffffff;
        }
        .submit-global-button:hover {
            background-color: var(--ci-secondary-hover);
            transform: scale(1.05);
        }
        
        .content-funnel { margin-top: 30px; display: flex; flex-direction: column; gap: 15px; }
        .funnel-stage { background-color: var(--bg-light); border: 1px solid var(--border-color); border-radius: 8px; }
        .funnel-header {
            display: flex; align-items: center; gap: 15px;
            padding: 15px 20px; background-color: #f0f5f5;
            border-bottom: 1px solid var(--border-color);
            border-top-left-radius: 8px; border-top-right-radius: 8px;
        }
        .funnel-icon { font-size: 1.8rem; line-height: 1; }
        .funnel-stage-title {
            margin: 0; font-family: 'Domine', serif;
            font-size: 18px; color: var(--ci-text-dark);
        }
        .funnel-body { padding: 20px; }
        .funnel-content-piece { font-weight: 600; color: #000; margin-top: 0; font-family: 'Figtree', sans-serif; }
        .funnel-explanation { font-size: 15px; margin-bottom: 0; color: var(--ci-text-grey); }

        #successMessage, #errorMessage { display: none; text-align:center; padding: 12px; margin-top: 20px; border-radius: 8px; font-weight: bold; }
        #successMessage { color: #0f5132; background-color: #d1e7dd; border: 1px solid #badbcc; }
        #errorMessage { color: #842029; background-color: #f8d7da; border: 1px solid #f5c2c7; }
        
        .progress-container {
            margin-bottom: 25px;
            margin-top: 15px;
        }
        .progress-bar-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
            color: var(--ci-text-dark);
        }
        .progress-bar-background {
            background-color: var(--border-color);
            border-radius: 10px;
            height: 12px;
            overflow: hidden;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
        }
        .progress-bar-fill {
            background-color: var(--ci-primary);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease-in-out;
        }
        .progress-bar-labels {
             display: flex; 
             justify-content: space-between; 
             font-size: 12px; 
             margin-top: 4px;
             color: var(--ci-text-grey);
        }

        @media (max-width: 768px) {
            .responsive-table thead { display: none; }
            .responsive-table tr { display: block; margin-bottom: 20px; border: 1px solid var(--border-color); border-radius: 8px; overflow: hidden; }
            .responsive-table td { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; padding: 12px 15px; text-align: right; border-bottom: 1px solid #eee; }
            .responsive-table tr td:last-child { border-bottom: none; }
            .responsive-table td::before { content: attr(data-label); font-weight: bold; text-align: left; margin-right: 15px; color: var(--ci-text-dark); }
            .responsive-table td:first-child { display: block; text-align: left; background-color: #f9f9f9; padding: 15px; }
            .responsive-table td:first-child::before { display: none; }
            .footer-button-container {justify-content: center;}
        }
    </style>
</head>
<body>
    <div class="brochure">
        <header class="header">
            <img src="https://backinthebuilding.com/wp-content/uploads/2024/12/cropped-LOGOS.pdf-200-x-200-px.png" alt="Logo Back in the Building GmbH">
            <h1>Content-Freigabe: KW 40</h1>
            <p>Kampagne: PROOF_OF_VALUE_Q3 | Fokus: Unsichtbare Sicherheit & Rutschgefahr</p>
        </header>
        <section class="section">
            <h2>Die Strategie für KW 40</h2>
             <div class="progress-container">
                <div class="progress-bar-info">
                    <span>Kampagnen-Fortschritt</span>
                    <span>Woche 4 von 10</span>
                </div>
                <div class="progress-bar-background">
                    <div class="progress-bar-fill" style="width: 40%;"></div>
                </div>
                <div class="progress-bar-labels">
                    <span>Start: KW 33</span>
                    <span>Verbleibend: 6 Wochen</span>
                    <span>Ende: KW 42</span>
                </div>
            </div>
            <p>Diese Woche adressieren wir eine der größten Sorgen im Badezimmer: die Rutschgefahr. Wir positionieren uns als Experte für präventive Sicherheitslösungen, die die Ästhetik des Bades nicht beeinträchtigen. Der Fokus liegt auf unseren technologisch fortschrittlichen Anti-Rutsch-Produkten und dem USP der "unsichtbaren Sicherheit", um das Vertrauen weiter zu stärken und neue Anwendungsfälle für unsere Expertise aufzuzeigen.</p>
            
            <div class="content-funnel">
                <div class="funnel-stage">
                    <div class="funnel-header">
                        <span class="funnel-icon">💡</span>
                        <h3 class="funnel-stage-title">Das Herzstück (Problemlösung aufzeigen)</h3>
                    </div>
                    <div class="funnel-body">
                        <p class="funnel-content-piece"><strong>Asset:</strong> Blog-Artikel "Rutschgefahr im Bad: Unsichtbare Lösungen..."</p>
                        <p class="funnel-explanation"><strong>Die Rolle:</strong> Dient als umfassender Ratgeber, der das Problembewusstsein schärft und unsere unsichtbaren Anti-Rutsch-Behandlungen als die ideale, ästhetische Lösung präsentiert.</p>
                    </div>
                </div>

                <div class="funnel-stage">
                    <div class="funnel-header">
                        <span class="funnel-icon">📣</span>
                        <h3 class="funnel-stage-title">Die Verbreitung (Reichweite & Interaktion)</h3>
                    </div>
                    <div class="funnel-body">
                        <p class="funnel-content-piece"><strong>Assets:</strong> GMB Post (Teaser), E-Mail Newsletter, Facebook Post (Umfrage)</p>
                        <p class="funnel-explanation"><strong>Die Rolle:</strong> Wir schaffen Aufmerksamkeit für das neue Thema, leiten Traffic zum Blog und regen durch interaktive Formate die Community zum Nachdenken über die eigene Badsicherheit an.</p>
                    </div>
                </div>

                <div class="funnel-stage">
                    <div class="funnel-header">
                        <span class="funnel-icon">📞</span>
                        <h3 class="funnel-stage-title">Die Aktivierung (Beratung anbieten)</h3>
                    </div>
                    <div class="funnel-body">
                        <p class="funnel-content-piece"><strong>Assets:</strong> GMB Angebot (Kostenlose Erstberatung)</p>
                        <p class="funnel-explanation"><strong>Die Rolle:</strong> Wir wandeln das geschärfte Problembewusstsein in konkrete Anfragen um, indem wir eine niederschwellige, kostenlose Beratung als nächsten Schritt anbieten.</p>
                    </div>
                </div>
                 <div class="funnel-stage">
                    <div class="funnel-header">
                        <span class="funnel-icon">🚀</span>
                        <h3 class="funnel-stage-title">Die Skalierung (Autorität ausbauen)</h3>
                    </div>
                    <div class="funnel-body">
                        <p class="funnel-content-piece"><strong>Assets:</strong> Outreach (Pitch GAST_001), Outreach (Recherche Social Koop)</p>
                        <p class="funnel-explanation"><strong>Die Rolle:</strong> Wir nutzen unseren erstellten Experten-Content, um Partnerschaften zu schließen und legen gleichzeitig den Grundstein für zukünftige Kooperationen im Social-Media-Bereich.</p>
                    </div>
                </div>
            </div>
        </section>
        <section class="section" id="approvalSection">
            <h2>Entwürfe zur finalen Prüfung & Freigabe</h2>
            <p>Hier finden Sie die finalen Entwürfe für alle geplanten Inhalte der KW 40. Bitte prüfen Sie die Dokumente, geben Sie Feedback und erteilen Sie Ihre Freigabe direkt in der Tabelle.</p>
            <table class="responsive-table">
                <thead>
                    <tr>
                        <th style="width: 35%;">Inhalt (Asset)</th>
                        <th>Entwurf</th>
                        <th style="text-align: center;">Bewertung</th>
                        <th style="width: 25%;">Änderungswunsch</th>
                        <th style="text-align: center;">Freigabe</th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-asset-id="BLOG_004">
                        <td data-label="Inhalt"><span class="asset-title">Blog-Artikel</span><span class="asset-description">"Rutschgefahr im Bad..."</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-blog4" name="rating-BLOG_004" value="5"><label for="star5-blog4">★</label><input type="radio" id="star4-blog4" name="rating-BLOG_004" value="4"><label for="star4-blog4">★</label><input type="radio" id="star3-blog4" name="rating-BLOG_004" value="3"><label for="star3-blog4">★</label><input type="radio" id="star2-blog4" name="rating-BLOG_004" value="2"><label for="star2-blog4">★</label><input type="radio" id="star1-blog4" name="rating-BLOG_004" value="1"><label for="star1-blog4">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-BLOG_004" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-BLOG_004" name="approve-BLOG_004" class="approval-checkbox"><label for="approve-BLOG_004" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                     <tr data-asset-id="GMB_009">
                        <td data-label="Inhalt"><span class="asset-title">GMB: Neuigkeit</span><span class="asset-description">"Sagen Sie Rutschgefahr den Kampf an!"</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-gmb9" name="rating-GMB_009" value="5"><label for="star5-gmb9">★</label><input type="radio" id="star4-gmb9" name="rating-GMB_009" value="4"><label for="star4-gmb9">★</label><input type="radio" id="star3-gmb9" name="rating-GMB_009" value="3"><label for="star3-gmb9">★</label><input type="radio" id="star2-gmb9" name="rating-GMB_009" value="2"><label for="star2-gmb9">★</label><input type="radio" id="star1-gmb9" name="rating-GMB_009" value="1"><label for="star1-gmb9">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-GMB_009" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-GMB_009" name="approve-GMB_009" class="approval-checkbox"><label for="approve-GMB_009" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                    <tr data-asset-id="FB_007">
                        <td data-label="Inhalt"><span class="asset-title">Facebook: Interaktion</span><span class="asset-description">"Wie rutschsicher ist Ihr Bad?"</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-fb7" name="rating-FB_007" value="5"><label for="star5-fb7">★</label><input type="radio" id="star4-fb7" name="rating-FB_007" value="4"><label for="star4-fb7">★</label><input type="radio" id="star3-fb7" name="rating-FB_007" value="3"><label for="star3-fb7">★</label><input type="radio" id="star2-fb7" name="rating-FB_007" value="2"><label for="star2-fb7">★</label><input type="radio" id="star1-fb7" name="rating-FB_007" value="1"><label for="star1-fb7">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-FB_007" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-FB_007" name="approve-FB_007" class="approval-checkbox"><label for="approve-FB_007" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                    <tr data-asset-id="GMB_010">
                        <td data-label="Inhalt"><span class="asset-title">GMB: Angebot</span><span class="asset-description">"Kostenlose Erstberatung Sicherheit"</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-gmb10" name="rating-GMB_010" value="5"><label for="star5-gmb10">★</label><input type="radio" id="star4-gmb10" name="rating-GMB_010" value="4"><label for="star4-gmb10">★</label><input type="radio" id="star3-gmb10" name="rating-GMB_010" value="3"><label for="star3-gmb10">★</label><input type="radio" id="star2-gmb10" name="rating-GMB_010" value="2"><label for="star2-gmb10">★</label><input type="radio" id="star1-gmb10" name="rating-GMB_010" value="1"><label for="star1-gmb10">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-GMB_010" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-GMB_010" name="approve-GMB_010" class="approval-checkbox"><label for="approve-GMB_010" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                     <tr data-asset-id="PITCH_001">
                        <td data-label="Inhalt"><span class="asset-title">Outreach: Pitch</span><span class="asset-description">"GAST_001 an Partner anbieten"</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-pitch1" name="rating-PITCH_001" value="5"><label for="star5-pitch1">★</label><input type="radio" id="star4-pitch1" name="rating-PITCH_001" value="4"><label for="star4-pitch1">★</label><input type="radio" id="star3-pitch1" name="rating-PITCH_001" value="3"><label for="star3-pitch1">★</label><input type="radio" id="star2-pitch1" name="rating-PITCH_001" value="2"><label for="star2-pitch1">★</label><input type="radio" id="star1-pitch1" name="rating-PITCH_001" value="1"><label for="star1-pitch1">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-PITCH_001" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-PITCH_001" name="approve-PITCH_001" class="approval-checkbox"><label for="approve-PITCH_001" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                    <tr data-asset-id="FB_008">
                        <td data-label="Inhalt"><span class="asset-title">Facebook: Post</span><span class="asset-description">"Hinter den Kulissen: Staubfrei"</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-fb8" name="rating-FB_008" value="5"><label for="star5-fb8">★</label><input type="radio" id="star4-fb8" name="rating-FB_008" value="4"><label for="star4-fb8">★</label><input type="radio" id="star3-fb8" name="rating-FB_008" value="3"><label for="star3-fb8">★</label><input type="radio" id="star2-fb8" name="rating-FB_008" value="2"><label for="star2-fb8">★</label><input type="radio" id="star1-fb8" name="rating-FB_008" value="1"><label for="star1-fb8">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-FB_008" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-FB_008" name="approve-FB_008" class="approval-checkbox"><label for="approve-FB_008" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                     <tr data-asset-id="SOCIAL_001">
                        <td data-label="Inhalt"><span class="asset-title">Outreach: Recherche</span><span class="asset-description">"Partner für Social Media Koop"</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-social1" name="rating-SOCIAL_001" value="5"><label for="star5-social1">★</label><input type="radio" id="star4-social1" name="rating-SOCIAL_001" value="4"><label for="star4-social1">★</label><input type="radio" id="star3-social1" name="rating-SOCIAL_001" value="3"><label for="star3-social1">★</label><input type="radio" id="star2-social1" name="rating-SOCIAL_001" value="2"><label for="star2-social1">★</label><input type="radio" id="star1-social1" name="rating-SOCIAL_001" value="1"><label for="star1-social1">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-SOCIAL_001" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-SOCIAL_001" name="approve-SOCIAL_001" class="approval-checkbox"><label for="approve-SOCIAL_001" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                    <tr data-asset-id="MAIL_004">
                        <td data-label="Inhalt"><span class="asset-title">E-Mail Newsletter</span><span class="asset-description">"Wie Sie Rutschgefahr einfach lösen"</span></td>
                        <td data-label="Entwurf"><a href="#" class="view-button" target="_blank">Ansehen</a></td>
                        <td data-label="Bewertung"><div class="rating"><input type="radio" id="star5-mail4" name="rating-MAIL_004" value="5"><label for="star5-mail4">★</label><input type="radio" id="star4-mail4" name="rating-MAIL_004" value="4"><label for="star4-mail4">★</label><input type="radio" id="star3-mail4" name="rating-MAIL_004" value="3"><label for="star3-mail4">★</label><input type="radio" id="star2-mail4" name="rating-MAIL_004" value="2"><label for="star2-mail4">★</label><input type="radio" id="star1-mail4" name="rating-MAIL_004" value="1"><label for="star1-mail4">★</label></div></td>
                        <td data-label="Änderungswunsch"><textarea name="feedback-MAIL_004" class="feedback-textarea" placeholder="Feedback..."></textarea></td>
                        <td data-label="Freigabe" style="text-align: center;"><input type="checkbox" id="approve-MAIL_004" name="approve-MAIL_004" class="approval-checkbox"><label for="approve-MAIL_004" class="approval-label"><span class="text-approve">Freigeben</span><span class="text-approved">✔ Freigegeben</span></label></td>
                    </tr>
                </tbody>
            </table>
            
            <div class="footer-button-container">
                <button id="resetButton" class="footer-button reset-button">Eingaben zurücksetzen</button>
                <button id="submitButton" class="footer-button submit-global-button">
                    <span class="button-text">Alle Freigaben & Feedback Senden</span>
                </button>
            </div>
            <div id="successMessage"></div>
            <div id="errorMessage"></div>
        </section>
    </div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const approvalSection = document.getElementById('approvalSection');
    const submitButton = document.getElementById('submitButton');
    const resetButton = document.getElementById('resetButton');
    const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzvkJLvkLmp75M2ZtOc5HJrxs5W8Tvd8wFSoJ3pCLN8bdtLvYSDkTnXCcZ3QIvbzlUI/exec';
    const storageKey = 'contentApproval_BITB_KW40_2025';

    const successMessageDiv = document.getElementById('successMessage');
    const errorMessageDiv = document.getElementById('errorMessage');

    window.feedbackGesendet = function(response) {
        submitButton.disabled = false;
        submitButton.querySelector('.button-text').textContent = 'Alle Freigaben & Feedback Senden';

        if (response.status === 'Erfolg') {
            successMessageDiv.innerHTML = `✔ ${response.processedCount} Einträge erfolgreich übermittelt.`;
            successMessageDiv.style.display = 'block';
            submitButton.querySelector('.button-text').textContent = 'Eingaben aktualisieren';
            setTimeout(() => { successMessageDiv.style.display = 'none'; }, 5000);
        } else {
            errorMessageDiv.innerHTML = `Ein Fehler ist aufgetreten: ${response.nachricht}`;
            errorMessageDiv.style.display = 'block';
        }
    };

    submitButton.addEventListener('click', function() {
        submitButton.disabled = true;
        submitButton.querySelector('.button-text').textContent = 'Sende...';
        successMessageDiv.style.display = 'none';
        errorMessageDiv.style.display = 'none';

        const feedbackPayload = [];
        const assetRows = approvalSection.querySelectorAll('tbody tr[data-asset-id]');
        
        assetRows.forEach(row => {
            const assetId = row.dataset.assetId;
            const ratingInput = row.querySelector(`input[name="rating-${assetId}"]:checked`);
            const feedbackInput = row.querySelector(`textarea[name="feedback-${assetId}"]`);
            const approvalInput = row.querySelector(`input[name="approve-${assetId}"]`);
            
            feedbackPayload.push({
                asset_id: assetId,
                bewertung: ratingInput ? ratingInput.value : 'N/A',
                feedback: feedbackInput ? feedbackInput.value.trim() : '',
                status: approvalInput.checked ? 'Freigegeben' : 'Offen'
            });
        });

        const payload = {
            kundenId: 'KUNDE_003',
            freigabeTyp: 'Wochenfreigabe',
            zeitraum: 'KW40-2025',
            daten: feedbackPayload
        };
        
        const dataString = encodeURIComponent(JSON.stringify(payload));
        const finalUrl = `${WEB_APP_URL}?callback=feedbackGesendet&data=${dataString}`;
        
        document.querySelectorAll('script[src*="script.google.com"]').forEach(s => s.remove());
        
        let scriptTag = document.createElement('script');
        scriptTag.src = finalUrl;

        scriptTag.onerror = function() {
            errorMessageDiv.innerHTML = 'Netzwerkfehler: Das Freigabe-Skript konnte nicht geladen werden. Bitte prüfen Sie Ihre Internetverbindung.';
            errorMessageDiv.style.display = 'block';
            submitButton.disabled = false;
            submitButton.querySelector('.button-text').textContent = 'Alle Freigaben & Feedback Senden';
        };
        
        document.body.appendChild(scriptTag);
    });

    const saveData = () => {
        const data = {};
        approvalSection.querySelectorAll('input[type="radio"], input[type="checkbox"], textarea').forEach(el => {
            const name = el.name;
            if (el.type === 'radio') { if (el.checked) data[name] = el.value; } 
            else if (el.type === 'checkbox') { data[name] = el.checked; } 
            else { data[name] = el.value; }
        });
        localStorage.setItem(storageKey, JSON.stringify(data));
    };

    const loadData = () => {
        const savedData = localStorage.getItem(storageKey);
        if (!savedData) return;
        const data = JSON.parse(savedData);
        for (const name in data) {
            const elements = approvalSection.querySelectorAll(`[name="${name}"]`);
            elements.forEach(el => {
                if (el.type === 'radio') { if (el.value === data[name]) el.checked = true; } 
                else if (el.type === 'checkbox') { el.checked = data[name]; } 
                else { el.value = data[name]; }
            });
        }
    };
    
    resetButton.addEventListener('click', function() {
        if (confirm('Möchten Sie wirklich alle Bewertungen, Kommentare und Freigaben zurücksetzen?')) {
            approvalSection.querySelectorAll('input[type=radio], input[type=checkbox]').forEach(el => el.checked = false);
            approvalSection.querySelectorAll('textarea').forEach(el => el.value = '');
            localStorage.removeItem(storageKey);
            document.querySelector('#submitButton .button-text').textContent = 'Alle Freigaben & Feedback Senden';
        }
    });

    approvalSection.addEventListener('input', saveData);
    loadData();
});
</script>
</body>
</html>
